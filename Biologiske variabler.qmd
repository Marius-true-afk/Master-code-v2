---
title: "Biologiske variabler"
date: "`r format(Sys.time(), '%d %B, %Y')`"
author: Marius Émil Lid
format: 
  html:
    self-contained: true
    code-tools: 
      source: true
---

#### Endring i biologiske variabler over tid

I denne delen tar jeg for meg endringer i lengde, vekt, alder og kjønnsratio. **Jeg er usikker på optimalt fremgangsmåte, så jeg velger å prøve meg frem med ulike dataframstillinger**.

```{r}
#| message: false
#| warning: false
#| echo: false

#install.packages()
```

### Lengde

```{r}
#| message: false
#| warning: false
#| echo: false

library(here)
library(dplyr)
library(ggplot2)

herring_data_raw <- read.csv(
  here("HerringData.csv"))

herring_data_clean <- herring_data_raw |> 
  mutate(
    year = as.numeric(year),
    length = as.numeric(length)
  )
```

```{r}
#| message: false
#| warning: false

library(patchwork)

p <- herring_data_clean |> 
     select(year, length)

p1 <- ggplot(herring_data_clean, aes(x = factor(year), y = length)) +
  geom_boxplot()

p2 <-ggplot(herring_data_clean, aes(x = NULL, y = length)) +
  geom_boxplot()

(p1 | p2) + plot_annotation(
    title = "Test plots",
    tag_levels = 'A'
    )
```

Prøver å lage box-plot kun for lengden i år 2000.

```{r}
#| message: false
#| warning: false

library(patchwork)

herring_year_2000 <- herring_data_clean |> 
     filter(year == 2000)

ggplot(herring_year_2000, aes(x = factor(year), y = length)) +
  geom_boxplot(fill = "skyblue", alpha = 0.7) +
  labs(
    title = "Length distribution of herring in year 2000",
    x = "Year",
    y = "Length (cm)"
  ) +
  theme_minimal()
```

Sjekker boxplots for perioden 2000 - 2010.

```{r}
#| message: false
#| warning: false

herring_years_2000_2010 <- herring_data_clean |> 
     filter(between(year, 2000, 2010))

ggplot(herring_years_2000_2010, aes(x = factor(year), y = length)) +
  geom_boxplot(fill = "skyblue", alpha = 0.6) +
  labs(
    title = "Variation in Herring Length from year 2000 - 2010",
    x = "Years",
    y = "Length (cm)"
  ) +
  theme_minimal()
```

Prøver å lage boxplots for ulike 10 år. Bruker "cut" framfor "floor" slik at jeg kan definere tom. årene 1935-1940 og 2010-2019.

```{r}
#| message: false
#| warning: false

herring_grouped_decades <- herring_data_clean |> 
  mutate(decade = cut(
    year,
    breaks = c(1935, 1945, 1955, 1965, 1975, 1985, 1995, 2005, 2015, 2019),
    labels = c("1935-1945", "1946-1955", "1956-1965", "1966-1975", "1976-1985", "1986-1995", "1996-2005", "2006-2015", "2016-2019"),
    include.lowest = TRUE,  # include boundary years
    right = TRUE    #intervales with form (a,b])
  ))

ggplot(herring_grouped_decades, aes(x = decade, y = length)) +
  geom_boxplot(fill = "skyblue", alpha = 0.6) +
  labs(
    title = "Variation in Herring Length by Timeperiode (Decade)",
    x = "Decade",
    y = "Length (cm)"
  ) +
  theme_minimal()
```

Avslutter med å lage et felles box-plot for hele perioden 1935 - 2019

```{r}
#| message: false
#| warning: false

ggplot(herring_data_clean, aes(x = "", y = length)) +
  geom_boxplot(fill = "skyblue", alpha = 0.6) +
  labs(
    title = "Variation in Herring Length from year 1935 - 2019",
    x = "All years",
    y = "Length (cm)"
  ) +
  theme_minimal()
```

\########################################################################

### Vekt

På lik måte som for lengde så prøver jeg meg fram

```{r}
#| message: false
#| warning: false
#| echo: false

library(here)
library(dplyr)
library(ggplot2)

herring_data_raw <- read.csv(
  here("HerringData.csv"))

herring_data_clean_weight <- herring_data_raw |> 
  mutate(
    year = as.numeric(year),
    weight = as.numeric(weight)
  )
```

Lager box-plot kun for vekten i år 2000.

```{r}
library(patchwork)

herring_weight_2000 <- herring_data_clean_weight |> 
     filter(year == 2000)

ggplot(herring_weight_2000, aes(x = factor(year), y = weight)) +
  geom_boxplot(fill = "pink", alpha = 0.7) +
  labs(
    title = "Weight distribution of herring in year 2000",
    x = "Year",
    y = "Weight (gram)"
  ) +
  theme_minimal()
```

Lager boxplots av vekten til silden for perioden 2000 - 2010.

```{r}
#| message: false
#| warning: false

herring_weight_2000_2010 <- herring_data_clean_weight |> 
     filter(between(year, 2000, 2010))

ggplot(herring_weight_2000_2010, aes(x = factor(year), y = weight)) +
  geom_boxplot(fill = "pink", alpha = 0.6) +
  labs(
    title = "Variation in Herring Weight from year 2000 - 2010",
    x = "Years",
    y = "Weight (gram)"
  ) +
  theme_minimal()
```

Lager boxplots for vektfordeling gjennom 10 år fra 1935 - 2019

```{r}
#| message: false
#| warning: false

herring_grouped_decades_weight <- herring_data_clean_weight |> 
  mutate(decade = cut(
    year,
    breaks = c(1935, 1945, 1955, 1965, 1975, 1985, 1995, 2005, 2015, 2019),
    labels = c("1935-1945", "1946-1955", "1956-1965", "1966-1975", "1976-1985", "1986-1995", "1996-2005", "2006-2015", "2016-2019"),
    include.lowest = TRUE,  # include boundary years
    right = TRUE    #intervales with form (a,b])
  ))

ggplot(herring_grouped_decades_weight, aes(x = decade, y = weight)) +
  geom_boxplot(fill = "pink", alpha = 0.6) +
  labs(
    title = "Variation in Herring Length by Timeperiode (Decade)",
    x = "Decade",
    y = "Weight (gram)"
  ) +
  theme_minimal()
```

Avslutter med et boxplot for vektfordeling i perioden 1935 - 2019

```{r}
#| message: false
#| warning: false

ggplot(herring_data_clean_weight, aes(x = "", y = weight)) +
  geom_boxplot(fill = "pink", alpha = 0.6) +
  labs(
    title = "Variation in Herring weight from year 1935 - 2019",
    x = "All years",
    y = "Weight (gram)"
  ) +
  theme_minimal()
```
